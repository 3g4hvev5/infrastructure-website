<!doctype html>
<html class="no-js" lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Using the code signing service # - Apache Infrastructure</title>
    <link rel="stylesheet" href="https://infra-test.apache.org/theme/css/foundation.css">
    <link rel="stylesheet" href="https://infra-test.apache.org/theme/css/app.css">
    <link rel="stylesheet" href="https://infra-test.apache.org/theme/css/font-awesome.min.css">
  </head>
  <body style="background: #C9B191;">
    <!-- Menu bar --->
    <div class="row">
      <div class="top-bar" style="padding: 0; margin-bottom: 10px; background: #222; border: 1px solid #DDD; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px;">
        <div class="hide-for-small-only">
          <div class="top-bar-left">
            <ul class="menu" style="background: #222; padding: 0px; line-height: 1; border-bottom-left-radius: 4px;">
              <li class="notable-logo"><a href="/" target="_self" style="padding: 3px; padding-left: 7px;">
                <img style="vertical-align: middle;" src='https://infra-test.apache.org/theme/images/feather.png' width='18'/><span style="font-size: 1.30rem; color: #1583CC; text-transform: uppercase;">Apache Infrastructure</span></a>
              </li>
            </ul>
          </div>
          <div class="top-bar-right">
            <ul class="dropdown menu horizontal" data-dropdown-menu style="background: #222; font-size: 0.8rem; text-transform: uppercase; padding-top: 5px;">
              <li><a href="/reference/" target="_self" style="padding-left: 5px;">Documentation</a></li>
              <li class="is-dropdown-submenu-parent">
                <a href="#" target="_self" style="padding-left: 0px;">Services and Status</a>
                <ul class="menu" style="background: #222; font-size: 0.7rem; text-transform: uppercase; padding-top: 5px; margin-top: 5px;">
                <li><a href="https://status.apache.org/" >Status Report</a></li>
                <li><a href="https://issues.apache.org/jira/" >JIRA</a></li>
                <li><a href="https://cwiki.apache.org/" >Confluence</a></li>
                <li><a href="https://builds.apache.org/" >Jenkins</a></li>
                <li><a href="https://ci.apache.org/" >Buildbot</a></li>
                </ul>
              </li>
              <li class="is-dropdown-submenu-parent">
                <a href="#" target="_self" style="padding-left: 7px;">Self Serve</a>
                <ul class="menu" style="background: #222; font-size: 0.7rem; text-transform: uppercase; padding-top: 5px; margin-top: 5px;">
                  <li><a href="/self-serve/acreq/">Account requests</a></li>
                  <li><a href="/self-serve/mlreq/">Mailing lists</a></li>
                  <li><a href="/self-serve/reporeq/">New git repository</a></li>
                  <li><a href="/self-serve/id/">Edit account information</a></li>
                  <li><a href="/contact.html">Other inquiries</a></li>
                </ul>
              </li>
              <li class="is-dropdown-submenu-parent">
                <a href="#" target="_self" style="padding-left: 7px;">About</a>
                <ul class="menu" style="background: #222; font-size: 0.7rem; text-transform: uppercase; padding-top: 5px; margin-top: 5px;">
                  <li><a href="/team.html">About the team</a></li>
                  <li><a href="/policies.html">Our policies</a></li>
                  <li><a href="/roadmap.html">Strategies & Roadmap</a></li>
                  <li><a href="/contact.html">Contact infrastructure</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>    
    <!-- bread crumb -->
    <div class="row">
      <div class="large-12 columns" style="font-size: 0.8rem; background-color: rgba(255,255,255,0.75); margin-bottom: 5px;">
        <a href="/">Home</a>
        <i class="fa fa-angle-double-right"></i>
        <a href="https://infra-test.apache.org/reference/pmc/codesigning.html">
Using the code signing service #        </a>
      </div>
    </div>
    
    
    <!-- contents -->
    <div class="row">
      <div class="large-12 columns">
        <div class="callout">
          <h2>
              Using the code signing service #
          </h2>
              <p>The code signing service permits both test signing and production signing.</p>
<p><strong>Production signing costs the ASF real money</strong>. The production signing service must only be used once the release process is working using test signing.</p>
<p>Once you are granted access to the siging service, you will be issued with a personal certificate by Symantec. You need this to access the code signing GUI.</p>
<p>The producion system is available at:
<a href="https://securesigning.websecurity.symantec.com/csportal/">https://securesigning.websecurity.symantec.com/csportal/</a></p>
<p>When you submit a signing request, you have an option the option to perform a production signing or a test signing.</p>
<h2>GUI</h2>
<h3>Signing files</h3>
<p>This is a quick guide to creating a new signing set. It assumes you have a file or set of files. It uses the Tomcat Windows installer as an example.</p>
<ul>
<li>Start at the dashboard</li>
<li>Select signing sets</li>
<li>Click "Add Signing set"</li>
<li>Provide a name e.g "Apache Tomcat 8.5"</li>
<li>Provide a version e.g. "8.5.4"</li>
<li>Select the signing service e.g. "Microsoft Windows Signing"</li>
<li>Upload the file(s) to be signed</li>
<li>Click "Sign Now"</li>
<li>Select Test or Production</li>
<li>Click Sign</li>
<li>You can then download the signed files</li>
</ul>
<h3>Adding users</h3>
<p>This is a quick guide to adding new users to the PMC's signing organisation</p>
<ul>
<li>Start at the dashboard</li>
<li>Click "Users"</li>
<li>Click "Add user"</li>
<li>Fill in the form using details (name, asf email etc) as shown in Whimsy</li>
<li>Choose a random enrollment password and send that to the new user</li>
<li>Normally, set all users as admins</li>
</ul>
<h2>SOAP API</h2>
<p>The <a href="https://svn.apache.org/repos/private/foundation/Correspondence/Symantec/">SOAP API documentation</a> is under an NDA. Please do not share it outside your PMC and if you do share it with other PMC members make sure they are aware of the NDA. Note: The previous link is accessible only to ASF members. If you need a copy of the API docs request it via a PMC member who is also an ASF member. If that is not possible, infra can provide a copy.</p>
<h2>Ant task</h2>
<p>The Apache Tomcat project has written an <a href="http://svn.apache.org/viewvc/tomcat/trunk/java/org/apache/tomcat/buildutil/SignCode.java?view=annotate">Ant task</a> that uses the SOAP interface to sign release artefacts as part of the build process.</p>
<p>In order to use the SOAP interface, your PMC account needs to be enabled for API accessed. Please open an INFRA Jira ticket against the code signing component to request this. Once this is approved you will be given:</p>
<ul>
<li>user name</li>
<li>password</li>
<li>partner code</li>
</ul>
<p>You will need all three to access the API.</p>
<p>Note that this Ant task currently uses a fixed buffer of 16MB to store the zipped artefacts for signing. If yoru artefacts are larger than that, you will need to use a larger buffer. Patches to switch to streaming the artefacts rather than buffering them welcome.</p>
<h2>Maven plug-in</h2>
<p>This is a work in progress.</p>
<h2>Signing services</h2>
<p>You will also need to specify the name of the signing service to use. The names are shown in the table below:
<table>
  <tr><th>Arftefact type</th><th>Test signing service name</th><th>Production signing service name</th></tr>
  <tr><td>Windows binary (.exe, .dll, .cab, etc.)</td><td>Microsoft TEST Signing</td><td>Microsoft Windows Signing</td></tr>
  <tr><td>Java Signing (*.jar)</td><td>Java TEST Signing</td><td>Java Signing</td></tr>
</table></p>
<p>Both SHA1 and SHA256 versions of the Java Signing service are available. Generally the SHA256 service is recommended. However, if you are re-signing JARs that have already been signed you'll need to ensure you use the same hash algorithm as the original signature else you will break the original signature.</p>
<p>Java signing is not intended to replace the current requirement for releases to be OpenPGP signed. Neither is it intended to replace the process of providing OpenPGP signatures for JARs uploaded to Maven central. It is intended for those use cases that require individual JAR files to be signed using the standard Java JAR signing process where the signature is contained within the JAR. Such us cases include Java Web Start, Eclipse plug-ins, etc.</p>
<h2>Signing events</h2>
<p>A signing event is the process of signing one or more files. Whether you use the web GUI or the SOAP API, the files must have unique names. This might require files to be renamed prior to signing and renamed back afterwards. Note that this does not affect the signature of the file.</p>
<p>We have discovered that the signing service is particular about file extensions. If you do rename the file, ensure that
you retain the correct file extension.</p>
<p>Each signing event can be reverted individually.</p>
<p>It is possible to request production or test signing on both the production and test systems. Note only a production signing event on the production system costs the ASF a code signing credit.</p>
<p>It is recommended that projects start testing with production signing on the test environment and get their process working there before moving to the production environment.</p>
        </div>
      </div>
    </div>
    </div>    
    <!-- footer -->
    <div class="row">
      <div class="large-12 medium-12 columns">
        <p style="font-style: italic; font-size: 0.8rem; text-align: center;">
          Copyright 2016, <a href="https://www.apache.org/">The Apache Software Foundation</a>, Licensed under the Apache License, Version 2.0.<br/>
          Apache and the Apache feather logo are trademarks of The Apache Software Foundation.
        </p>
      </div>
    </div>    
    <script src="https://infra-test.apache.org/theme/js/vendor/jquery.js"></script>
    <script src="https://infra-test.apache.org/theme/js/vendor/what-input.js"></script>
    <script src="https://infra-test.apache.org/theme/js/vendor/foundation.js"></script>
    <script src="https://infra-test.apache.org/theme/js/app.js"></script>
  </body>
</html>
